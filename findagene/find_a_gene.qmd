---
title: "fina_a_gene"
author: "Xinlong Wan"
format: html
---

# import alignment

```{r}
library(bio3d)

aln = read.fasta("multi_align.clw.fst")
i_score = seqidentity(aln, normalize=TRUE, similarity=FALSE, ncore=1, nseg.scale=1)

i_score
```

```{r}
# Plot identity matrix
plot.dmat(i_score, color.palette = heat.colors, axes=TRUE,
          main="Sequence Identity", xlab="Sequence",
          ylab="Sequence")
```

```{r}
colnames(i_score)[7] <- "Human"
rownames(i_score)[7] <- "Human"
i_score

```


```{r}

par(mar=c(10,10,4,1)+.1)
fig <- heatmap(i_score, margins=c(10,6))

fig
```


# blast

```{r}
seq = "LAVGQVELGGGPGAGSLQPLALEGSLQKRGIVEQCCTSICSLYQLENYCN"
blast_result <- blast.pdb(seq, database = "pdb", time.out = NULL, chain.single=TRUE)

```

```{r}
blast_result
```



```{r}
ano <- pdb.annotate(blast_result$hit.tbl$subjectids)
```
```{r}
ano[, c(5,6,11)]
```

```{r}
get.pdb("1ZEI_A")
```



